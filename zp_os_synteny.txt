# 4 May 2020
# WD: /home/jkimball/haasx092/synteny_figure
# Purpose of this code is to generate a synteny figure showing Zizania palustris and Oryza sativa genomes as linear blocks with links between the two

# Python needs to be loaded
module load python

# First, make bed files from GFF3 files.
# Wild Rice GFF3 file was generated by Marissa as part of the annotation project; Oryza files came from Phytozome (python -m jcvi.apps.fetch phytozome Osativa)
python -m jcvi.formats.gff bed rice.gene_structures_post_PASA_updates.21917.gff3 -o wild_rice.bed
python -m jcvi.formats.gff bed Osativa_323_v7.0.gene.gff3.gz -o oryza.bed

# Next, reformat FASTA files
python -m jcvi.formats.fasta format zizania_palustris_13Nov2018_okGsv.fasta wild_rice.cds
python -m jcvi.formats.fasta format Osativa_323_v7.0.cds.fa.gz oryza.cds

# Find pairwise synteny
python -m jcvi.compara.catalog ortholog wild_rice oryza --no_strip_names

# At this stage, the process is aborted because "A total of 0 anchor was found. Aborted" (exact error message)